# 2026-02-13

- Continued anti-hallucination hardening for Mycelium companion path.
- Added local-intent classifier in `mycelium/mycelium_pulse.py` to prevent ambiguous local requests from falling through to gateway.
- Added deterministic local capability response for OpenClawd/local-access queries.
- Added local action receipts on `/companion/local-action` responses (`id`, `at`, `kind`, `ok`, optional `path`) with `verified_local=true`.
- Updated dashboard frontend (`state.js`, `main.js`, `render.js`) to annotate local responses as `LOCAL VERIFIED` and include receipt IDs in chat log entries.
- Added regression tests for receipt metadata, capability statement, and unparsed-local-intent guardrail.
- Validation:
  - `python -m py_compile mycelium/mycelium_pulse.py` passed.
  - `node --check` passed for dashboard JS modules.
  - `pytest mycelium/tests/test_companion_local_action.py` passed (8 tests).
  - Live endpoint checks on `http://127.0.0.1:8765/companion/local-action` confirmed new behavior.
- Implemented backend gateway-response validator endpoint: `POST /companion/validate-response`.
- Added violation detection for `cloud_limit_contradiction`, `tool_output_fabrication`, and `unverified_execution_claim`.
- Wired dashboard frontend to call backend validator before rendering gateway replies, with client-side fallback guardrail.
- Added 10-case hallucination evaluation suite: `mycelium/tests/test_hallucination_eval_suite.py`.
- Added one-command ship gate: `python mycelium/ship_gate.py`.
- Ship gate result: PASS (Python compile, JS syntax checks, companion regression tests, hallucination eval suite).
- Restarted live server on port 8765 and validated new endpoint behavior live.
- Added guardrail observability log sink: `mycelium/data/guardrail_events.jsonl` via backend validator.
- Extracted frontend guardrail resolution into reusable module `mycelium/static/dashboard/guardrail.mjs`.
- Added frontend e2e-lite guardrail flow tests: `mycelium/tests_js/guardrail_flow.test.mjs`.
- Added backend guardrail logging tests: `mycelium/tests/test_guardrail_logging.py`.
- Expanded ship gate to include API syntax check, guardrail logging tests, and frontend guardrail flow tests.
- Re-ran full gate after expansion: PASS.
- Added live Guardrail Watch panel to dashboard backed by `/companion/guardrail-events`.
- Added backend reader helper for recent guardrail events and exposed feed endpoint with `limit` parameter.
- Added frontend polling for guardrail feed and rendering of violation summaries + user message snippets.
- Added endpoint tests for guardrail feed (`limit` behavior and missing-log handling).
- Restarted Mycelium Pulse on port 8765 and verified dashboard contains Guardrail Watch + live feed returns event data.
- Gateway diagnostics: verified dashboard service on 8765 and gateway service on 18789; gateway process currently up (PID 26568).
- UX clarity update: added plain-language Quick Start panel and live status summary in dashboard.
- Added gateway helper text + explicit Reconnect button in Gateway Channel.
- Added gateway auto-reconnect loop (4s retry) with manual reconnect hook.
- Ship gate re-run after UX/reconnect changes: PASS.
- Added deterministic companion handling for ambiguous prompts:
  - plain `what can you do?`
  - `do you have full autonomy`
  - `how will you do this`
  - workspace repair prompts including `confirm repair`
- Added verified local repair diagnostics in `mycelium/mycelium_pulse.py`:
  - live port checks for Pulse `127.0.0.1:8765` and gateway `127.0.0.1:18789`
  - guardrail-event volume surfaced as a concrete repair signal
- Hardened `/companion/validate-response` against fabricated workspace diagnostics:
  - new violations: `unverified_workspace_diagnostic`, `nonexistent_workspace_artifact_claim`
- Expanded regression coverage:
  - `mycelium/tests/test_companion_local_action.py` now `10/10` passing
  - `mycelium/tests/test_hallucination_eval_suite.py` now `11/11` passing
- Restarted live Mycelium Pulse process so runtime loads patched code (new PID 8584 on port 8765).
- Live endpoint checks now confirm:
  - `POST /companion/local-action` handles capability + repair queries locally with receipts
  - `POST /companion/validate-response` blocks fake component/repair narratives
- Reworked `mycelium/dashboard.html` into a companion-first layout:
  - central avatar + personal companion context
  - chat moved to primary focus area
  - one-click prompt chips (`what can you do?`, `confirm repair`, `create MIST.md`)
  - technical telemetry moved to collapsible advanced section
- Replaced dashboard visual system in `mycelium/static/dashboard/styles.css` with warm, intimate design language and cleaner hierarchy.
- Updated `mycelium/static/dashboard/render.js`:
  - dynamic companion greeting tied to profile + connection state
  - friendlier quick status summary copy
  - prompt-chip click handling wired to send messages instantly
- Validation after UI rewrite:
  - `node --check` passed for updated frontend modules
  - `python mycelium/ship_gate.py` passed
  - live `/dashboard` check returned 200 with new companion-focused headings
- Guarded a new persona-drift pathway from transcript replay:
  - Added deterministic local responses for companion-avatar advancement prompts in `mycelium/mycelium_pulse.py`.
  - Added explicit clarifier handling for exact message `i meant yours` to keep replies practical and non-hallucinated.
- Expanded companion local-action regression coverage:
  - `mycelium/tests/test_companion_local_action.py` now `12/12` passing (added avatar-advancement + clarifier cases).
- Re-ran `python mycelium/ship_gate.py` after patch: PASS.
- Companion UX overhaul to reduce corporate feel and reinforce "actual companion" presence:
  - Reworked dashboard copy and section labeling in `mycelium/dashboard.html` (Presence, Talk with MIST, Bond Settings, Behind The Scenes, System Journal).
  - Replaced visual system in `mycelium/static/dashboard/styles.css` with softer glass/dawn theme, expressive typography, ambient texture, and staged motion.
  - Tuned runtime phrasing and chat formatting in `mycelium/static/dashboard/render.js` for warmer companion language.
  - Post-overhaul validation: `python mycelium/ship_gate.py` PASS.
